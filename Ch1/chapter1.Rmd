---
title: "沖本本　第一章"
site: bookdown::bookdown_site
output:
  bookdown::gitbook: default
---
#問題（p.17）
## 弱定常過程において、$\gamma_{k}=\gamma_{-k}$が成立することを確認せよ。
弱定常過程はp.24に載っている$y_{t}=\mu+\epsilon_{t}, \epsilon_{t} \sim W . N .\left(\sigma^{2}\right)$  　(1.8)とします。
採用するデータは、`JohnsonJohnson`にします。このデータは1960〜1980年におけるジョンソン＆ジョンソンのシェアあたりの四半期収益を示す時系列データです。
それでは、問題に取り組んでいきます。

```{r}
# 外部パッケージ
library(tidyverse)

# 対象データ
dataset <- JohnsonJohnson
# datasetの平均と標準偏差
mu <- mean(dataset); sd <- sd(dataset)
# 定数k
k <- runif(1, min = 1, max = length(dataset)) %>% as.integer()
# ホワイトノイズ
set.seed(1)
white.noise <- rnorm(n = length(dataset), mean = 0, sd = sd)
white.noise_ts <- ts(white.noise, start = 1)
# 弱定常過程
y_t <- mu + white.noise_ts
# k次のラグデータ
y_t_k <- stats::lag(x=y_t, k=k)
gamma_k_t <- cov(y_t, y_t_k)
# γ_-k
y_t_minusk <- stats::lag(x=y_t, k=-k)
gamma_minusk <- cov(y_t, y_t_minusk)
# 問題文の式が成り立つか確認
gamma_k_t == gamma_minusk
```
これで、視覚的に$\gamma_{k}=\gamma_{-k}$が成立することが確認できます。


## $y_{t}=\mu+\epsilon_{t}, \epsilon_{t} \sim W . N .\left(\sigma^{2}\right)$　(1.8)が弱定常過程であることを確認せよ。
任意のtとkに対して

$\begin{aligned} E\left(y_{t}\right) &=\mu \\ \operatorname{Cov}\left(y_{t}, y_{t-k}\right) &=E\left[\left(y_{t}-\mu\right)\left(y_{t-k}-\mu\right)\right]=\gamma_{k} \end{aligned}$

が成立する場合、過程は弱定常（定常）といわれます。(p.8)

対象とする過程が定常過程かどうかは、[ADF検定](https://ja.wikipedia.org/wiki/%E6%8B%A1%E5%BC%B5%E3%83%87%E3%82%A3%E3%83%83%E3%82%AD%E3%83%BC%E2%80%93%E3%83%95%E3%83%A9%E3%83%BC%E6%A4%9C%E5%AE%9A)により確認することができます。ADF検定とは、帰無仮説「過程が単位根過程である」が棄却されれば定常過程であるとする検定です。単位根過程については、5章で詳しく述べられています。
```{r}
tseries::adf.test(y_t)
```
この結果には、p値が0.01以下であることが示されています。よって、帰無仮説は棄却され、$y_{t}=\mu+\epsilon_{t}, \epsilon_{t} \sim W . N .\left(\sigma^{2}\right)$　(1.8)は定常過程であるといえます。

1.1と1.2の数式に基づいた解法は[こちら](https://qiita.com/aokikenichi/items/2c833ecd4ef2e3c77443)のQiita記事をご覧になるとよいでしょう。